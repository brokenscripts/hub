; execve-Stack.nasm
; SLAE32
; EXECVE using Stack method, no NULL
; 
; int execve(const char *pathname, char *const argv[], char *const envp[]);
;   - execve does NOT need a return if successful
; EAX = syscall
; EBX = /bin/bash, 0x0
; ECX = Address of /bin/bash,0x00000000
; EDX = 0x00000000
; ESI -> /bin/bash
;

global _start

section .text
_start: 

    xor eax, eax
    push eax            ; Push 0x00000000 (NULL DWORD)
    push 0x68736162     ; hsab          ////bin/bash - 12 chars, divisible by 4, and NULL terminated ^
    push 0x2f6e6962     ; /nib
    push 0x2f2f2f2f     ; ////

    mov ebx, esp        ; MOV address of ////bin/bash string just PUSH'd into EBX

    push eax            ; Push 0x00000000 (NULL DWORD) for EDX prep
    mov edx, esp        ; MOV this null address location in EDX register

    push ebx            ; Save address of WHERE the ////bin/bash,0x0 string is onto stack
    mov ecx, esp        ; MOV address of string into ECX

    mov al, 11
    int 0x80